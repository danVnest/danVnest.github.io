$(document).ready(function(){function t(t){n.height(t?5*u:u),d.height(u),h.height(u)}function e(){if(g>1)for(i=j;v>i;i+=j)$("#project-list .item").slice(i-j,i).wrapAll('<div class="column"></div>');$("#project-list .item").slice((g-1)*j).wrapAll('<div class="column"></div>'),$("#project-list .column").each(function(t){$(this).attr("data-column",t),$("#project-list .controls ol").append('<li data-column="'+t+'"></li>')}),$("#project-list .controls li").click(function(t){t.preventDefault(),$("#project-list .active").removeClass("active"),$('#project-list [data-column="'+$(this).data("column")+'"]').addClass("active"),$("#project-list .carousel").transition({left:-$("#project-list .column.active").position().left})}),$("#project-list .column").first().addClass("active"),$("#project-list .controls li").first().addClass("active"),$("#project-list .carousel").transition({left:-$("#project-list .column.active").position().left}),$("#project-list .carousel").width($("#project-list .column").outerWidth()*g).css("margin",(w-j*f)/2+"px 0")}function o(){w=u-$("#project-list .intro").outerHeight()-$("#project-list .controls").outerHeight();var t=w-$("#project-list .carousel").height();t>=0&&f>=t?$("#project-list .carousel").css("margin",(w-j*f)/2+"px 0"):(j=Math.floor(w/f),g=Math.ceil(v/j),$("#project-list .column").contents().unwrap(),$("#project-list .controls li").remove(),e())}function a(){$("#circle-arrow").attr("d","m20,30 q0,"+.3*u+" "+.5*-r.width()+","+.4*u),$("#switch-arrow").attr("d","m20,30 q"+.1*r.width()+","+.2*u+" "+.2*-r.width()+","+.55*u),$("#search-arrow").attr("d","m20,30 q"+.1*r.width()+","+.2*u+" "+.2*r.width()+","+.5*u),$("#search-arrow2").attr("d","m10,15 q"+.2*r.width()+",20 "+.2*r.width()+",-30"),$("#project-arrow").attr("d","m10,15 q"+.1*r.width()+",-10 "+.1*r.width()+",25")}function c(){for(;x.outerWidth()>k.outerWidth();)x.css({"font-size":parseInt(x.css("font-size"))-1,padding:parseFloat(x.css("padding"))+.5})}function s(){$("header .controls .active").removeClass("active");var t=$("header .items .active").transition({opacity:"0"},p),e=t.data("item")+1;0==$('header [data-item="'+e+'"]').length&&(e=0),setTimeout(function(){t.removeClass("active"),q||$('header [data-item="'+e+'"]').addClass("active").filter(".item").transition({opacity:"1"},p)},p)}var r=$("html, body"),n=$("header"),l=$("nav"),d=$("#project-list"),h=$("#project"),p=1e3,m="/images/bg"+(Math.round(8*Math.random())+1)+".jpg";$('<img src="'+m+'" />').load(function(){n.css("background",'url("'+m+'") no-repeat center center fixed'),$("header .items").removeClass("solid")});var u=$(window).innerHeight()-l.height();t(!0);var v=$("#project-list .item").last().data("item")+1,f=140,w=u-$("#project-list .intro").outerHeight()-$("#project-list .controls").outerHeight(),j=Math.floor(w/f),g=Math.ceil(v/j);e();var C=!1;window.getComputedStyle(document.querySelector(".sticky")).position.match("sticky")||(l.removeClass("sticky"),C=!0);var y=0;$(window).scroll(function(){$(window).scrollTop()<n.height()?0!=y&&(C&&l.removeClass("docked"),$("#sectionLabel span").text("Daniel Vogelnest"),$("#switch svg").transition({perspective:"100px",rotateX:"0deg"},p),y=0):$(window).scrollTop()<n.height()+d.height()?1!=y&&($("#sectionLabel span").text("Projects"),$("#switch svg").transition({perspective:"100px",rotateX:"180deg"},p),C&&0==y&&l.addClass("docked"),y=1):2!=y&&($("#sectionLabel span").text($("#project-list .item.selected h3").text()),$("#switch svg").transition({perspective:"100px",rotateX:"540deg"},p),y=2)}),a();var k=$("#notice"),x=$("#notice h1");c();var T="daniel.vogelnest",b="me.com";$(".email").attr("href","mailto:"+T+"@"+b).text(T+"@"+b),n.transition({height:u},p),setTimeout(function(){$('header [data-item="0"]').addClass("active").filter(".item").transition({opacity:"1"},p)},p);var D=1e4,q=!1,H=setInterval(s,D);$("header .controls li").click(function(t){if(t.preventDefault(),!$(this).hasClass("active")){q=!0,clearInterval(H),H=setInterval(s,D),$("header .controls .active").removeClass("active"),$(this).addClass("active");var e=$("header .items .active").transition({opacity:"0"},p),i=$(this).data("item");setTimeout(function(){e.removeClass("active"),q&&$('header [data-item="'+i+'"]').addClass("active").filter(".item").transition({opacity:"1"},p),q=!1},p)}});var M=$("#search").innerWidth();$("#switch").click(function(t){t.preventDefault(),1==y?r.animate({scrollTop:0},500):r.animate({scrollTop:n.height()},500)}),$("#search div").focusin(function(){r.animate({scrollTop:n.height()},500);var t=$(window).innerWidth();$("#search").transition({width:t-10}),$("#sectionLabel, #switch").transition({opacity:0}),$("#search .cancel").transition({opacity:1})}),$("#search div").focusout(function(){$("#search").transition({width:M}),$("#sectionLabel, #switch").transition({opacity:1}),$("#search .cancel").transition({opacity:0})}),$("#project-list .item").click(function(t){t.preventDefault(),$("#project").fadeIn(),$("section .selected").removeClass("selected"),$('section [data-item="'+$(this).data("item")+'"]').addClass("selected"),r.animate({scrollTop:n.height()+d.height()},500)}),$("#project-list .control-arrow.left").click(function(t){t.preventDefault();var e=$("#project-list .active").removeClass("active"),i=e.data("column")-1;0==$('#project-list [data-column="'+i+'"]').length&&(i=g-1),$('#project-list [data-column="'+i+'"]').addClass("active"),$("#project-list .carousel").transition({left:-$("#project-list .column.active").position().left})}),$("#project-list .control-arrow.right").click(function(t){t.preventDefault();var e=$("#project-list .active").removeClass("active"),i=e.data("column")+1;0==$('#project-list [data-column="'+i+'"]').length&&(i=0),$('#project-list [data-column="'+i+'"]').addClass("active"),$("#project-list .carousel").transition({left:-$("#project-list .column.active").position().left})}),$(window).resize(function(){u=$(window).innerHeight()-l.height(),t(!1),a(),c(),o(),$(window).scrollTop(u*y)})}),$(window).on("beforeunload",function(){$(window).scrollTop(0)});